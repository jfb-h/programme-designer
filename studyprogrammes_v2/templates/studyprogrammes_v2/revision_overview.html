{% extends "base.html" %}
{% block content %}
<h2 style="text-align:center;">Revisionen</h2>
<div style="display: flex; flex-direction: column; align-items: center;">
  <button onclick="openModal()" style="margin-bottom: 1.5em; padding: 0.5em 1.2em; border-radius: 5px; border: 1px solid #888; background: #f8f8f8; cursor: pointer;">Neue Revision anlegen</button>
  <table style="margin: 2em auto; min-width: 500px; border-collapse: collapse; background: #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.07);">
      <tr style="background: #f0f0f0;">
          <th style="padding: 0.7em 1em; border-bottom: 2px solid #ddd;">Name</th>
          <th style="padding: 0.7em 1em; border-bottom: 2px solid #ddd;">Autor</th>
          <th style="padding: 0.7em 1em; border-bottom: 2px solid #ddd;">Erstellt am</th>
          <!-- Add this column header -->
          <th style="padding: 0.7em 1em; border-bottom: 2px solid #ddd;">Aktionen</th>
      </tr>
      {% for rev in revisions %}
      <tr style="border-bottom: 1px solid #eee;">
          <td style="padding: 0.5em 1em;">{{ rev.name }}</td>
          <td style="padding: 0.5em 1em;">{{ rev.author.get_full_name|default:rev.author.username }}</td>
          <td style="padding: 0.5em 1em;">{{ rev.created_at|date:"Y-m-d H:i" }}</td>
          <!-- In the for loop for each revision -->
          <td style="padding: 0.5em 1em; text-align: center;">
            <a href="{% url 'v2_edit_revision' revision_id=rev.id %}" style="padding:0.3em 0.8em; border-radius:4px; border:1px solid #bbb; background:#f4f4f4; text-decoration:none; color:#222;">Bearbeiten</a>
          </td>
      </tr>
      {% empty %}
      <tr>
          <td colspan="4" style="padding: 1em; text-align: center;">Keine Revisionen vorhanden.</td>
      </tr>
      {% endfor %}
  </table>
</div>

<!-- Modal for creating a new revision -->
<div id="modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.3); z-index:1000;">
  <div style="background:#fff; margin:5vh auto; padding:2em; width:400px; border-radius:8px; position:relative; box-shadow:0 4px 24px rgba(0,0,0,0.13);">
    <button onclick="closeModal()" style="position:absolute; top:10px; right:10px; font-size:1.5em; background:none; border:none; cursor:pointer;">&times;</button>
    <h3 style="margin-top:0;">Neue Revision anlegen</h3>
    <form method="post">
      {% csrf_token %}
      {{ form.as_p }}
      <button type="submit" style="margin-top:1em; padding:0.5em 1.2em; border-radius:5px; border:1px solid #888; background:#f8f8f8; cursor:pointer;">Speichern</button>
    </form>
  </div>
</div>
<script>
function openModal() {
  document.getElementById('modal').style.display = 'block';
}
function closeModal() {
  document.getElementById('modal').style.display = 'none';
}
</script>
{% endblock %}